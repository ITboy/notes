# 如何写好代码 #

## 面向对象 ##

### 空指针的问题 ###

代码报空指针是很烦的问题，常常改完了这处的空指针，另外一处又报，如何能从根本上保证代码中没有这种错误，其实是一个思想上的问题。

#### 空指针怎么产生的？ ####

毋庸置疑，在函数执行过程中产生的，而在面向对象的思想中，函数分两种：

* 类级别的静态函数
* 对象级别的非静态函数

在这两种执行上下文中，都可能产生空指针异常。 而在这两种执行上下文中对象的来源有三种：

* 参数传递
* 对象的成员变量
* 类级别的静态变量

在这两种上下文中，当尝试访问的对象的成员变量或成员函数，而他们为null时就会报空指针。

### 如何避免空指针？ ###

对象的来源可以是上述的三种，参数传递、成员变量、类级别的静态变量。

对于类级别的静态变量，最好的习惯是在初始化时就赋值，这样当类被class loader加载的时候就会有值。

``` java
public class A {
	public static B b = new B();
}
```

对于成员变量，在定义类的时候就要界定好，这个对象一旦被构造，哪些成员是不应该为空的，也就是说哪些属性是required的，这些属性要在构造函数中赋值（参数传递或默认值），这样在在构造函数中，就保证这个对象的一些required属性不为空，对于非必须的属性，将来在代码执行过程中会通过setter方法来设置值。对于这种前面执行的代码可能会调用setter方法来设置对象属性的，就要在后面的代码中显式的检查。

对于参数传递，可以加断言，而对于有业务逻辑含义的，要加条件判断来处理。 

总结：
1. 类级别的静态变量在定义时一定要初始化
2. 划定对象级别的成员变量哪些是required，保证他们在构造函数中为他设定好值
3. 对于通过参数传递的对象，或者对象级别的非required对象但被前面的代码可能设置，这时就要区分，如果可以断言为非空，就使用断言，如果可能为空，就使用条件判断来处理。

